<dom-module id="jso-pathivar-form">
        <style>
            :host {
                display: block;
                position: relative;
                box-sizing: border-box;
                padding: 15px 40px;

                z-index: 50000;
                margin: 0px auto 0px auto;

                max-width: 1000px;
                border: 1px solid #c6d0da;
                transition: all 0.2s;
                box-shadow: 2px 6px 15px 8px rgba(0, 0, 0, 0.30);
                background-color: #FFFFFF;
            }

            .title {
                text-align: center;
                font-size: 20px;
                color: #666;
            }

            .icon {
                color: #445D76;
                font-size: 50px;
            }

            .message {
                margin-top: 20px;
            }

            .check-panel {
                margin-top: 5px;
                margin-right: 5px;
            }

            .check-list {
                box-sizing: border-box;
                overflow-y: auto;
                height: 300px;
                padding: 8px 10px;
            }

            .check-name {
                line-height: 25px;
                margin-left: 10px;
            }

            .checkbox {
                width: 25px;
                border: 1px solid gray;
                margin: 1px;
            }

            .checkbox::after {
                font-family: 'FontAwesome';
                content: ' \00a0'
            }

            .checkbox[data-checked]::after {
                content: '\f00c'
            }

            .lbl {
                line-height: 25px;
            }

            .botbar {
                margin-top: 10px;
            }

            jso-project-browser {
                height: 400px;
                border: 1px solid #d3d3d3;
                border-top-width: 0px;
                margin-top: 10px;
                box-shadow: none;
            }

            .errmsg {
                color: #8b0000;
                margin-bottom: 5px;
            }

            .sgenesTextArea {
                box-sizing: border-box;
                width: 100%;
                height: 300px;
                resize: none;
            }

        </style>
        <template>
        <form id="form">
            <div class="title">
                <div>
                    <!--<font-awesome icon="rocket" class="icon"></font-awesome>-->
                    PATHiVAR input parameters
                </div>
                <!--<div class="icon">-->
                <!--<font-awesome icon="rocket" animation="spin"></font-awesome>-->
                <!--</div>-->
            </div>
            <br>


            <div horizontal layout end-justified style="margin-right:5px;">
                <div class="button action" style="margin-bottom:20px;width:150px;" on-click="{{runExample}}">
                    <font-awesome icon="rocket"></font-awesome>
                    &nbsp; Run example
                </div>
            </div>


            <div class="formbox">
                <div class="formtitle">
                    VCF file
                </div>
                <div class="formcontent">

                    <jso-project-browser-window
                            id="inputFile"
                            studies="{{studies}}"
                            selectedStudy="{{selectedStudy}}"
                            selectionMode="file"
                            allowTextArea="false"
                            on-file-select="{{handleFileSelect}}"
                            on-ok="{{handleFileSelect}}"
                            bioformat="VARIANT"
                            ></jso-project-browser-window>
                    <br>
                    <span class="errmsg">{{vcfFileMessage}}</span>

                    <!--<div class="button action" style="width:150px;" on-click="{{handleSelectFile}}">Select VCF file...-->
                    <!--</div>-->
                    <!--<div style="margin-top:5px;">-->
                    <!--{{selectedStudy.name}}-->
                    <!--<template if="{{selectedStudy}}">-->
                    <!--/-->
                    <!--</template>-->
                    <!--{{vcfFile.path}}-->
                    <!--</div>-->
                    <!--<template if="{{ showBrowser }}">-->
                    <!--<jso-project-browser-->
                    <!--on-file-select="{{handleBrowseSelect}}"-->
                    <!--studies="{{studies}}"-->
                    <!--selectedStudy="{{selectedStudy}}"-->
                    <!-->
                    <!--</jso-project-browser>-->
                    <!--<div horizontal layout end-justified-->
                    <!--style="padding:4px; background-color: #fafafa; border:1px solid #d3d3d3; border-top-width: 0;">-->
                    <!--<div class="button action" style="width:150px;margin-right:5px;"-->
                    <!--on-click="{{handleSelectFileCancel}}">-->
                    <!--Cancel-->
                    <!--</div>-->
                    <!--<div class="button action" style="width:150px;"-->
                    <!--on-click="{{handleSelectFileOk}}">-->
                    <!--OK-->
                    <!--</div>-->
                    <!--</div>-->
                    <!--</template>-->

                </div>
            </div>

            <div class="formbox">
                <div class="formtitle">
                    Sample name from VCF
                </div>
                <div class="formcontent">
                    <div class="select">
                        <select flex value="{{samplecol}}" required>
                            <template repeat="{{sampleName in sampleNames}}">
                                <option value="{{sampleName}}">{{sampleName}}</option>
                            </template>
                        </select>
                    </div>
                </div>
            </div>

            <div class="formbox">
                <div class="formtitle">
                    Inheritance pattern
                </div>
                <div class="formcontent">
                    <div class="select">
                        <select value="{{model}}" required>
                            <option value="recessive">Recessive</option>
                            <option value="dominant">Dominant</option>
                        </select>
                    </div>

                    <div hidden?="{{model == 'dominant'}}">
                        <label>Should compound heterozygotes be included?</label>
                        <br>

                        <div class="select">
                            <select value="{{comhom}}">
                                <option value="Y">Yes</option>
                                <option value="N">No</option>
                            </select>
                        </div>

                    </div>
                </div>
            </div>

            <div class="formbox">
                <div class="formtitle" horizontal layout>
                    <div flex>Consequence types</div>
                    <div style="font-size:13px;" class="button" on-click="{{handleSelectAllCt}}">Select all</div>
                    <div style="font-size:13px;" class="button" on-click="{{handleDeselectAllCt}}">Deselect all
                    </div>
                </div>
                <div class="formcontent fit">
                    <div class="check-list">
                        <template repeat="{{item in consequenceTypes}}">
                            <div horizontal layout>
                                <div class="button action checkbox" data-checked?="{{ item.selected }}"
                                     on-click="{{handleItemSelect}}"></div>
                                <div class="check-name">{{item.text}}</div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>


            <div class="formbox">
                <div class="formtitle">
                    Deleteriousness indexes
                </div>
                <div class="formcontent">
                    <div horizontal layout style="line-height: 25px;">
                        <div class="button action checkbox" data-checked?="{{ siftSelected }}"
                             on-click="{{handleSiftSelect}}"></div>
                        <div class="check-name" style="width:100px;">SIFT</div>

                        <div horizontal layout style="margin-left:10px;"
                             hidden?="{{ !siftSelected }}">
                            <div class="lbl">threshold: &nbsp;</div>
                            <div>
                                <input type="number" step="0.01" max="1" min="0" value="{{tresholdSift}}"
                                       required?="{{ siftSelected }}">
                            </div>

                            <div style="color:#666">&nbsp; Values below the threshold (0.05 default) predict protein
                                DAMAGE
                            </div>
                        </div>
                    </div>

                    <div horizontal layout style="line-height: 25px;">
                        <div class="button action checkbox" data-checked?="{{ polyphenSelected }}"
                             on-click="{{handlePolyphenSelect}}"></div>
                        <div class="check-name" style="width:100px;">PolyPhen</div>


                        <div horizontal layout style="margin-left:10px;"
                             hidden?="{{ !polyphenSelected}}">
                            <div class="lbl">treshold: &nbsp;</div>
                            <div>
                                <input type="number" step="0.01" max="1" min="0" value="{{tresholdPolyphen}}"
                                       required?="{{ polyphenSelected }}">
                            </div>
                            <div style="color:#666">&nbsp; Values over the threshold (0.95 default) predict protein
                                DAMAGE
                            </div>
                        </div>
                    </div>

                    <div horizontal layout style="line-height: 25px;">
                        <div class="button action checkbox" data-checked?="{{ consSelected }}"
                             on-click="{{handleConsSelect}}"></div>
                        <div class="check-name" style="width:100px;">PhastCons</div>

                        <template if="{{consSelected}}">
                            <div horizontal layout style="margin-left:10px;">
                                <div class="lbl">treshold: &nbsp;</div>
                                <div>
                                    <input type="number" max="1000" min="0" value="{{tresholdCons}}" required>
                                </div>
                                <div style="color:#666">&nbsp; Values over the threshold (200 default) predict DAMAGE
                                </div>
                            </div>
                        </template>

                    </div>
                </div>
            </div>

            <div vertical layout>
                <div class="formbox">
                    <div class="formtitle" horizontal layout>
                        <div flex>Pathways</div>
                        <div style="font-size:13px;" class="button" on-click="{{handleSelectAllPw}}">Select all</div>
                        <div style="font-size:13px;" class="button" on-click="{{handleDeselectAllPw}}">Deselect all
                        </div>
                    </div>
                    <div class="formcontent fit">
                        <div class="check-list">
                            <template repeat="{{item in pathwaysSet}}">
                                <div horizontal layout>
                                    <div class="button action checkbox" data-checked?="{{ item.selected }}"
                                         on-click="{{handleItemSelect}}"></div>
                                    <div class="check-name">{{item.name}}</div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>


                <div class="formbox">
                    <div class="formtitle" horizontal layout>
                        <div flex>Tissues</div>
                        <div style="font-size:13px;" class="button"
                             data-checked="{{selectedTissueSet == 'ea'}}"
                             on-click="{{handleExpressionTissues}}">Expression atlas
                        </div>
                        <div style="font-size:13px;" class="button"
                             data-checked="{{selectedTissueSet == 'hpa'}}"
                             on-click="{{handleHumanProteinTissues}}">Human protein atlas
                        </div>
                        <div style="font-size:13px;" class="button"
                             data-checked="{{selectedTissueSet == 'cus'}}"
                             on-click="{{handleCustomTissues}}">Custom
                        </div>
                    </div>
                    <div class="formcontent {{selectedTissueSet != 'cus' ? 'fit' : '' }}">
                        <div class="check-list" hidden?="{{selectedTissueSet == 'cus'}}">
                            <template repeat="{{item in tissues}}">
                                <div horizontal layout>
                                    <div class="button action checkbox" data-checked?="{{ item.selected }}"
                                         on-click="{{handleTissueItemSelect}}"></div>
                                    <div class="check-name">{{item.name}}</div>
                                </div>
                            </template>
                        </div>
                        <div hidden?="{{selectedTissueSet != 'cus'}}">
                            <div class="text">Write one gene name per line:</div>
                            <textarea id="customSgenesTextArea" class="sgenesTextArea"
                                    ></textarea>
                        </div>
                    </div>
                </div>
                <div class="formbox" hidden?="{{selectedTissueSet == 'cus'}}">
                    <div class="formtitle" horizontal layout>
                        <div flex>Additional gene list (optional)</div>
                    </div>
                    <div class="formcontent">
                        <div class="text">Write one gene name per line:</div>
                            <textarea id="additionalSgenesTextArea" class="sgenesTextArea"
                                    ></textarea>
                    </div>
                </div>
            </div>


            <!--<div class="botbar" horizontal layout center-justified>-->
            <!--<div class="text" style="color:#666">Job name:</div>-->
            <!--<input type="text" value="{{jobName}}" style="width: 150px;margin-right:10px;">-->

            <!--<div class="button action" style="width: 150px;" on-click="{{launchJob}}">-->
            <!--<font-awesome icon="rocket"></font-awesome>-->
            <!--&nbsp; Launch job-->
            <!--</div>-->
            <!--&lt;!&ndash;<div class="button action" style="width: 100px;" on-click="{{handleGetFolderIdToTest}}">&ndash;&gt;-->
            <!--</div>-->


            <div class="formbox">
                <div class="formtitle">Job information</div>
                <div class="formcontent">
                    <label>Output folder</label>
                    <jso-project-browser-window id="outdir" studies="{{studies}}" selectedStudy="{{selectedStudy}}"
                                                selectionMode="folder" showBrowser="false"></jso-project-browser-window>
                    <br>
                    <label>Job name</label>
                    <input type="text" id="jobName" value="{{jobName}}" required style="width:150px;">
                    <label>Description</label>
                    <textarea value="{{description}}" required></textarea>
                </div>
            </div>

            <div id="errors" class="errmsg">
                <template repeat="{{error in errors}}">
                    <div>{{error}}</div>
                </template>
            </div>

            <div class="botbar" horizontal layout center-justified>
                <div class="button action big" on-click="{{launchJob}}">
                    <font-awesome icon="rocket"></font-awesome>
                    &nbsp; Launch job
                </div>
            </div>

        </form>
        <div class="message">{{message}}</div>
        <div class="message">{{folderId}}</div>
    </template>

    <script>
        Polymer({
            is:'jso-pathivar-form',
            // created: function () {
            //     this._initVariables();
            //
            //     this.selectedStudy;
            //
            //     this.toolName = "pathiways";
            //     this.execution = "pathivar";
            //
            //     this.analysisId = 1;
            //     this.outdirId = 1222;
            //
            //     this.jobName = 'Pathivar job';
            //     this.description = 'Description';
            //
            //
            //     this.tresholdSift = 0.05;
            //     this.tresholdPolyphen = 0.95;
            //     this.tresholdCons = 200;
            //
            //     this.siftSelected = true;
            //     this.polyphenSelected = true;
            //     this.consSelected = false;
            //
            //     this.model = "recessive";
            //     this.comhom = "Y";
            //
            //     this.sampleNames = [];
            //
            //     this.tissues = this.expressionAtlasTissues;
            //     this.selectedTissueSet = 'ea'; // ea, hpa, cus
            //
            //     this.errors = [];
            // },
            sampleNamesChanged: function (oldValue, newValue) {
                this.samplecol = this.sampleNames[0];
            },
            handleSiftSelect: function (e) {
                this.siftSelected = !this.siftSelected;
            },
            handlePolyphenSelect: function (e) {
                this.polyphenSelected = !this.polyphenSelected;
            },
            handleConsSelect: function (e) {
                this.consSelected = !this.consSelected;
            },
            handleFileSelect: function (e) {
                this.vcfFile = this.$.inputFile.selectedFile;
                if (this.checkVcfFile()) {
                    this.getSamplesFromVcf();
                }
            },
            checkVcfFile: function () {
                var bool = this.vcfFile != null && Utils.endsWith(this.vcfFile.name, ".vcf");
                if (bool) {
                    this.vcfFileMessage = '';
                } else {
                    this.vcfFileMessage = 'This file is not VCF';
                }
                return bool;
            },
            handleBrowseSelect: function (e) {
                var file = e.detail.file;
                this.vcfFile = file;
                this.checkVcfFile();
            },
            handleItemSelect: function (e) {
                var item = e.target.templateInstance.model.item;
                item.selected = !item.selected;
            },
            handleTissueItemSelect: function (e) {
                for (var i = 0; i < this.humanProteinAtlasTissues.length; i++) {
                    var t = this.humanProteinAtlasTissues[i];
                    t.selected = false;
                }
                for (var i = 0; i < this.expressionAtlasTissues.length; i++) {
                    var t = this.expressionAtlasTissues[i];
                    t.selected = false;
                }
                var item = e.target.templateInstance.model.item;
                item.selected = !item.selected;
            },
            handleSelectAllPw: function () {
                for (var i = 0; i < this.pathwaysSet.length; i++) {
                    var pw = this.pathwaysSet[i];
                    pw.selected = true;
                }
            },
            handleDeselectAllPw: function () {
                for (var i = 0; i < this.pathwaysSet.length; i++) {
                    var pw = this.pathwaysSet[i];
                    pw.selected = false;
                }
            },
            handleSelectAllCt: function () {
                for (var i = 0; i < this.consequenceTypes.length; i++) {
                    var ct = this.consequenceTypes[i];
                    ct.selected = true;
                }
            },
            handleDeselectAllCt: function () {
                for (var i = 0; i < this.consequenceTypes.length; i++) {
                    var ct = this.consequenceTypes[i];
                    ct.selected = false;
                }
            },
            handleHumanProteinTissues: function () {
                this.tissues = this.humanProteinAtlasTissues;
                this.selectedTissueSet = 'hpa'; // ea, hpa, cus
            },
            handleExpressionTissues: function () {
                this.tissues = this.expressionAtlasTissues;
                this.selectedTissueSet = 'ea'; // ea, hpa, cus
            },
            handleCustomTissues: function () {
                this.tissues = null;
                this.selectedTissueSet = 'cus'; // ea, hpa, cus
            },
            getSamplesFromVcf: function () {
                var me = this;
                OpencgaManager.files.contentGrep({
                    id: this.vcfFile.id,
                    query: {
                        sid: Cookies('bioinfo_sid'),
                        ignoreCase: true,
                        multi: false,
                        pattern: encodeURIComponent('^#CHR.*')
                    },
                    request: {
                        async: false,
                        success: function (response) {
                            me.sampleNames = response.trim().split("\t").slice(9);
                        },
                        error: function () {
                            console.log('Server error, try again later.');
                        }
                    }
                });
            },
            _getStudyFolder: function (studyId) {
                var me = this;
                var folder;
                OpencgaManager.files.search({
                    query: {
                        sid: Cookies('bioinfo_sid'),
                        studyId: studyId,
                        name: '.'
                    },
                    request: {
                        async: false,
                        success: function (response) {
                            console.log(response);
                            if (response.response[0].errorMsg === '' || response.response[0].errorMsg == null) {
                                folder = response.response[0].result[0];
                            } else {
                                console.log(response.response[0].errorMsg)
                            }
                        },
                        error: function () {
                            console.log('Server error, try again later.');
                        }
                    }
                });
                return folder;
            },
            runExample: function () {
                var me = this;
                this.selectedStudy = this.studies[0];

                var folder = this._getStudyFolder(this.selectedStudy.id);

                OpencgaManager.jobs.create({
                    query: {
                        sid: Cookies("bioinfo_sid"),
                        execution: this.execution,
                        studyId: this.selectedStudy.id,
                        toolId: this.toolName,
                        name: "Pathivar example",
                        description: this.description,
                        outdir: folder.id,

                        annotvcf: "example_annotvcf1000g.vpa",
                        ctypes: "splice_acceptor_variant,splice_donor_variant,stop_gained,stop_lost,non_synonymous_codon,exon_variant",
                        samplecol: "NA19600",
                        pathways: "hsa04012,hsa04020,hsa04080,hsa04210",
                        tissue: "lung",
                        model: "recessive",
                        comhom: "Y",
                        methodscore: "siftpolyphen",
                        treshold: "0.05:0.85:NA",
                        tissueSet: "ea"
                    },
                    request: {
                        //method: 'POST',
                        success: function (response) {
                            if (response.response[0].errorMsg === '' || response.response[0].errorMsg == null) {
                                var jobId = response.response[0].result[0].id;
                                me.selectedOption = "jobLaunched"
                            } else {
                                me.message = response.response[0].errorMsg;
                            }
                            me.selectedStudy = null;
                        },
                        error: function () {
                            me.message = 'Server error, try again later.';
                        }
                    }
                });
            },
            launchJob: function () {
                var me = this;


//                this.vcfFile = "";
//                this.annotvcf = "/tmp/pv/annotvcf.vpa";
//                this.ctypes = "splice_acceptor_variant,splice_donor_variant,stop_gained,stop_lost,non_synonymous_codon,exon_variant"
//                this.samplecol = "muestra_A";
//                this.pathways = "hsa04012,hsa04020,hsa04080,hsa04210"
//                this.tissue = "lung"
//                this.model = "recessive"
//                this.comhom = "Y"
//                this.methodscore = "siftpolyphen"
//                this.treshold = "0.05:0.85:NA"


//                "outputParam": "outdir",
//                        "validParams": [
//                    {"name":"annotvcf", "description":"", "required":"false"},
//                    {"name":"vcfFile", "description":"", "required":"false"},
//
//                    {"name":"ctypes", "description":"", "required":"true"},
//                    {"name":"samplecol", "description":"", "required":"true"},
//                    {"name":"pathways", "description":"", "required":"true"},
//                    {"name":"tissue", "description":"", "required":"true"},
//                    {"name":"model", "description":"", "required":"true"},
//                    {"name":"comhom", "description":"", "required":"true"},
//                    {"name":"methodscore", "description":"", "required":"true"},
//                    {"name":"treshold", "description":"", "required":"true"},


//                this.consequenceTypes
//                this.humanProteinAtlasTissues
//                this.expressionAtlasTissues


                this.errors = [];

                var outdirId;
                if (this.$.outdir.selectedFile == null) {
                    this.selectedStudy = this.studies[0];
                    var folder = this._getStudyFolder(this.selectedStudy.id);
                    outdirId = folder.id;
                } else {
                    outdirId = this.$.outdir.selectedFile.id
                }

                var query = {};
                query['sid'] = Cookies("bioinfo_sid");
                query['execution'] = this.execution;
                query['studyId'] = this.selectedStudy.id;
                query['toolId'] = this.toolName;
                query['name'] = this.jobName != '' ? this.jobName : 'Pathivar job';
                query['description'] = this.description;
                query['outdir'] = outdirId;


                if (this.checkVcfFile()) {
                    query['vcfFile'] = this.vcfFile.id;
                } else {
                    this.errors.push("No input VCF file selected. Please select one. ");
                }
                if (this.samplecol != null) {
                    query['samplecol'] = this.samplecol;
                }
                if (this.model != null) {
                    query['model'] = this.model;
                }
                if (this.model == 'recessive') {
                    query['comhom'] = this.comhom;
                }


                var ctypes = [];
                for (var i = 0; i < this.consequenceTypes.length; i++) {
                    var ct = this.consequenceTypes[i];
                    if (ct.selected) {
                        ctypes.push(ct.name);
                    }
                }
                if (ctypes.length > 0) {
                    query['ctypes'] = ctypes;
                } else {
                    this.errors.push('Please select at least one Consequence Type');
                }


                var methodscore = '';
                var treshold = '';
                if (this.siftSelected) {
                    methodscore += 'sift';
                    treshold += this.tresholdSift;
                }
                if (this.polyphenSelected) {
                    methodscore += 'polyphen';
                    treshold += ':' + this.tresholdPolyphen;
                }
                if (this.consSelected) {
                    methodscore += 'cons';
                    treshold += ':' + this.tresholdCons;
                }
                if (methodscore == '') {
                    methodscore = 'none';
                }
                query['methodscore'] = methodscore;
                query['treshold'] = treshold;
//                this.methodscore != '' &&
//                this.treshold != '' &&


                var pathways = [];
                for (var i = 0; i < this.pathwaysSet.length; i++) {
                    var pathway = this.pathwaysSet[i];
                    if (pathway.selected) {
                        pathways.push('hsa' + pathway.value);
                    }
                }
                if (pathways.length > 0) {
                    query['pathways'] = pathways;
                } else {
                    this.errors.push('Please select at least one Pathway');
                }

                var tissue;
                switch (this.selectedTissueSet) {
                    case 'cus':
                        tissue = 'none';
                        var sgenes = this.$.customSgenesTextArea.value.trim().replace(/\n/g, '%0A');
                        if (sgenes != '') {
                            this.tissueMessage = '';
                            query['sgenes-text'] = sgenes;
                        } else {
                            this.errors.push('Please write at least one gene when using custom Tissue');
                        }
                        break;
                    case 'hpa':
                        var tissues = [];
                        for (var i = 0; i < this.humanProteinAtlasTissues.length; i++) {
                            var t = this.humanProteinAtlasTissues[i];
                            if (t.selected) {
                                tissues.push(t.name.replace(/ /gi, "_"));
                            }
                        }
                        tissue = tissues[0];
                        var sgenes = this.$.additionalSgenesTextArea.value.trim().replace(/\n/g, '%0A');
                        if (sgenes != '') {
                            query['sgenes-text'] = sgenes;
                        }
                        break;
                    case 'ea':
                        var tissues = [];
                        for (var i = 0; i < this.expressionAtlasTissues.length; i++) {
                            var t = this.expressionAtlasTissues[i];
                            if (t.selected) {
                                tissues.push(t.name.replace(/ /gi, "_"));
                            }
                        }
                        var sgenes = this.$.additionalSgenesTextArea.value.trim().replace(/\n/g, '%0A');
                        if (sgenes != '') {
                            query['sgenes-text'] = sgenes;
                        }
                        tissue = tissues[0];
                        break;
                }
                query['tissueSet'] = this.selectedTissueSet;
                if (tissue) {
                    query['tissue'] = tissue;
                } else {
                    this.errors.push('Please select one Tissue');
                }


                if (this.errors.length > 0) {
                    return;
                }

                console.log(this.$.form.checkValidity())


                if (this.$.form.checkValidity()) {
                    //                       annotvcf: this.annotvcf,
                    OpencgaManager.jobs.create({
                        query: query,
                        request: {
                            //method: 'POST',
                            success: function (response) {
                                if (response.response[0].errorMsg === '' || response.response[0].errorMsg == null) {
                                    var job = response.response[0].result[0];
                                    me.selectedOption = "jobLaunched"
                                    console.log(job);
//                                    me.message = job.commandLine;
                                } else {
                                    me.message = response.response[0].errorMsg;
                                }
                            },
                            error: function () {
                                me.message = 'Server error, try again later.';
                            }
                        }
                    });

                }

            },
            _initVariables: function () {
                this.pathwaysSet = [
                    {name: 'PPAR SIGNALING PATHWAY', selected: false, value: '03320'},
                    {name: 'ERBB SIGNALING PATHWAY', selected: true, value: '04012'},
                    {name: 'CALCIUM SIGNALING PATHWAY', selected: true, value: '04020'},
                    {
                        name: 'CYTOKINE-CYTOKINE RECEPTOR',
                        selected: false,
                        value: '04060',
                        id: 'pathways04060' + this.id
                    },
//            { name: 'CHEMOKINE SIGNALING PATHWAY', selected: false, value: '04062', id: 'pathways04062' + this.id},
                    {name: 'NEUROACTIVE LIGAND-RECEPTOR INTERACTION', selected: false, value: '04080'},
                    {name: 'p53 SIGNALING PATHWAY', selected: false, value: '04115', id: 'pathways04115' + this.id},
                    {name: 'mTOR SIGNALING PATHWAY', selected: false, value: '04150', id: 'pathways04150' + this.id},
                    {name: 'APOPTOSIS', selected: false, value: '04210'},
                    {name: 'WNT SIGNALING PATHWAY', selected: false, value: '04310'},
                    {name: 'NOTCH SIGNALING PATHWAY', selected: false, value: '04330'},
                    {
                        name: 'HEDGEHOG SIGNALING PATHWAY',
                        selected: false,
                        value: '04340',
                        id: 'pathways04340' + this.id
                    },
                    {name: 'VEGF SIGNALING PATHWAY', selected: false, value: '04370'},
                    {name: 'ECM-RECEPTOR INTERACTION', selected: false, value: '04512', id: 'pathways04512' + this.id},
                    {name: 'CELL ADHESION MOLECULES', selected: false, value: '04514'},
                    {name: 'TIGH JUNCTION', selected: false, value: '04530', id: 'pathways04530' + this.id},
                    {name: 'GAP JUNCTION', selected: false, value: '04540'},
                    {name: 'ANTIGEN PROCESING AND PRESENTATION', selected: false, value: '04612'},
                    {
                        name: 'TOLL-LIKE RECEPTOR SIGNALING PATHWAY',
                        selected: false,
                        value: '04620',
                        id: 'pathways04620' + this.id
                    },
                    {name: 'JAK-STAT SIGNALING PATHWAY', selected: false, value: '04630'},
                    {
                        name: 'T CELL RECPTOR SIGNALING PATHWAY',
                        selected: false,
                        value: '04660',
                        id: 'pathways04660' + this.id
                    },
                    {name: 'B CELL RECEPTOR SIGNALING PATHWAY', selected: false, value: '04662'},
                    {name: 'Fc EPSILON RI SIGNALING PATHWAY', selected: false, value: '04664'},
                    {name: 'INSULIN SIGNALING PATHWAY', selected: false, value: '04910'},
                    {name: 'GnRH SIGNALING PATHWAY', selected: false, value: '04912'},
                    {name: 'MELANOGENESIS', selected: false, value: '04916'},
                    {name: 'ADIPOCYTOKINE SIGNALING PATHWAY', selected: false, value: '04920'}
                ];

//                var str = "";
//                for (var i = 0; i < this.pathwaysSet.length; i++) {
//                    var pw = this.pathwaysSet[i];
//                    str += pw.value + "\t" + pw.name;
//                    if (i != this.pathwaysSet.length - 1) {
//                        str += "\n";
//                    }
//                }
//                var blob = new Blob([str], {type: "text/plain"});
//                var url = URL.createObjectURL(blob);
//                var link = document.createElement('a');
//                link.href = url;
//                link.download = "pathways.txt";
//                var event = new MouseEvent('click', {
//                    'view': window,
//                    'bubbles': true,
//                    'cancelable': true
//                });
//                link.dispatchEvent(event);

                this.consequenceTypes = [
                    {name: "splice_acceptor_variant", text: "splice acceptor variant", selected: true},
                    {name: "splice_donor_variant", text: "splice donor variant", selected: true},
                    {name: "stop_gained", text: "stop gained", selected: true},
                    {name: "stop_lost", text: "stop lost", selected: true},
                    {name: "non_synonymous_codon", text: "non synonymous codon", selected: true},
                    {name: "splice_region_variant", text: "splice region variant", selected: false},
                    {name: "synonymous_codon", text: "synonymous codon", selected: false},
                    {name: "exon_variant", text: "exon variant", selected: false},
                    {name: "coding_sequence_variant", text: "coding sequence variant", selected: false},
                    {name: "5_prime_UTR_variant", text: "5 prime UTR variant", selected: false},
                    {name: "3_prime_UTR_variant", text: "3 prime UTR variant", selected: false},
                    {name: "intron_variant", text: "intron variant", selected: false},


//                    {name: "NMD_transcript_variant", text: "NMD transcript variant", selected: false},
//                    {name: "nc_transcript_variant", text: "nc transcript variant", selected: false},
                    {name: "5KB_upstream_variant", text: "5KB upstream variant", selected: false},
                    {name: "5KB_downstream_variant", text: "5KB downstream variant", selected: false},
//                    {name: "TF_binding_site_variant", text: "TF binding site variant", selected: false},
//                    {name: "regulatory_region_variant", text: "regulatory region variant", selected: false},
//                    {name: "DNAseI_hypersensitive_site", text: "DNAseI hypersensitive site", selected: false},
//                    {name: "RNA_polymerase_promoter", text: "RNA polymerase promoter", selected: false},
//                    {name: "miRNA_target_site", text: "miRNA target site", selected: false},
//                    {name: "miRNA", text: "miRNA", selected: false},
//                    {name: "lincRNA", text: "lincRNA", selected: false},
//                    {name: "pseudogene", text: "pseudogene", selected: false},
//                    {name: "SNPe", text: "SNPe", selected: false},
//                    {name: "intergenic_variant", text: "intergenic variant", selected: false}
                ];

                this.humanProteinAtlasTissues = [
                    {name: "adrenal gland", selected: false},
                    {name: "appendix", selected: false},
                    {name: "bone marrow", selected: false},
                    {name: "breast", selected: false},
                    {name: "bronchus", selected: false},
                    {name: "cerebellum", selected: false},
                    {name: "cerebral cortex", selected: false},
                    {name: "cervix, uterine", selected: false},
                    {name: "colon", selected: false},
                    {name: "duodenum", selected: false},
                    {name: "endometrium 1", selected: false},
                    {name: "endometrium 2", selected: false},
                    {name: "epididymis", selected: false},
                    {name: "esophagus", selected: false},
                    {name: "fallopian tube", selected: false},
                    {name: "gallbladder", selected: false},
                    {name: "heart muscle", selected: false},
                    {name: "hippocampus", selected: false},
                    {name: "kidney", selected: false},
                    {name: "lateral ventricle", selected: false},
                    {name: "liver", selected: false},
                    {name: "lung", selected: false},
                    {name: "lymph node", selected: false},
                    {name: "nasopharynx", selected: false},
                    {name: "oral mucosa", selected: false},
                    {name: "ovary", selected: false},
                    {name: "pancreas", selected: false},
                    {name: "parathyroid gland", selected: false},
                    {name: "placenta", selected: false},
                    {name: "prostate", selected: false},
                    {name: "rectum", selected: false},
                    {name: "salivary gland", selected: false},
                    {name: "seminal vesicle", selected: false},
                    {name: "skeletal muscle", selected: false},
                    {name: "skin 1", selected: false},
                    {name: "skin 2", selected: false},
                    {name: "small intestine", selected: false},
                    {name: "smooth muscle", selected: false},
                    {name: "soft tissue 1", selected: false},
                    {name: "soft tissue 2", selected: false},
                    {name: "spleen", selected: false},
                    {name: "stomach 1", selected: false},
                    {name: "stomach 2", selected: false},
                    {name: "testis", selected: false},
                    {name: "thyroid gland", selected: false},
                    {name: "tonsil", selected: false},
                    {name: "urinary bladder", selected: false},
                    {name: "vagina", selected: false}
                ];

                this.expressionAtlasTissues = [
                    {name: "adipose tissue normal", selected: false},
                    {name: "adipose-derived adult stem cells", selected: false},
                    {name: "amygdala", selected: false},
                    {name: "B cell", selected: false},
                    {name: "bladder", selected: false},
                    {name: "bladder mucosa", selected: false},
                    {name: "blood", selected: false},
                    {name: "bone", selected: false},
                    {name: "brain", selected: false},
                    {name: "bronchial epithelia", selected: false},
                    {name: "bronchoalveolar lavage cell", selected: false},
                    {name: "caudate nucleus", selected: false},
                    {name: "CD138+ plasma cell", selected: false},
                    {name: "CD33+ cells", selected: false},
                    {name: "CD34+ blood cell", selected: false},
                    {name: "CD34+ blood cell thymus", selected: false},
                    {name: "cerebellum", selected: false},
                    {name: "conjunctiva", selected: false},
                    {name: "connective tissue fibroblast", selected: false},
                    {name: "dendritic cell", selected: false},
                    {name: "embryonic lung fibroblast", selected: false},
                    {name: "endothelial cell", selected: false},
                    {name: "epidermis", selected: false},
                    {name: "erythrocyte", selected: false},
                    {name: "esophagus epithelium", selected: false},
                    {name: "fetal lung", selected: false},
                    {name: "frontal cortex", selected: false},
                    {name: "granulocyte", selected: false},
                    {name: "heart", selected: false},
                    {name: "hematopoietic stem cell", selected: false},
                    {name: "hippocampus CA1", selected: false},
                    {name: "hypopharynx", selected: false},
                    {name: "hypothalamus", selected: false},
                    {name: "keratinocyte", selected: false},
                    {name: "kidney", selected: false},
                    {name: "kidney epithelium", selected: false},
                    {name: "leukocyte", selected: false},
                    {name: "liver", selected: false},
                    {name: "lung", selected: true},
                    {name: "lymph node", selected: false},
                    {name: "lymphocyte", selected: false},
                    {name: "macrophage", selected: false},
                    {name: "mesangial cell", selected: false},
                    {name: "mesenchymal stem cell", selected: false},
                    {name: "monocyte", selected: false},
                    {name: "mononuclear cell", selected: false},
                    {name: "multipotent adult progenitor cell", selected: false},
                    {name: "myometrium", selected: false},
                    {name: "oropharynx", selected: false},
                    {name: "ovary", selected: false},
                    {name: "placenta basal plate", selected: false},
                    {name: "prefrontal cortex", selected: false},
                    {name: "prostate gland", selected: false},
                    {name: "skeletal muscle", selected: false},
                    {name: "skin", selected: false},
                    {name: "small intestine", selected: false},
                    {name: "smooth muscle", selected: false},
                    {name: "T cell", selected: false},
                    {name: "testis", selected: false},
                    {name: "theca", selected: false},
                    {name: "thymocyte", selected: false},
                    {name: "thyrocyte", selected: false},
                    {name: "thyroid gland", selected: false},
                    {name: "tonsil", selected: false},
                    {name: "trabecular meshwork cell", selected: false},
                    {name: "umbilical vein endothelial cell", selected: false}
                ];
            }
        });
    </script>
</polymer-element>
